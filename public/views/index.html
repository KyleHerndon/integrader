<html>
    <head>
        <link rel=stylesheet href="/css/style.css" />
        <script src="/js/jquery.min.js"></script>
        <script src="/js/handlebars.js"></script>
        
        <title>Home</title>
        
        <script id="template" type="text/x-handlebars-template">
            <header>
                <a href="/"><div class="button logo"></div></a>
                <div class="button-area">
                    <div class="button button-settings"></div>
                    <a href="/"><div class="button button-home"></div></a>
                </div>
            </header>
            <div class="main-area">
                <div class="sidebar">
                    <h2 class="sidebar-header">Upcoming Assignments</h2>
                    <ul class="upcoming">
                        {{#each dates}}
                        <li>
                            {{{formatDate date}}}
                            {{#each assignments}}
                            <ul>
                                <a href="{{path}}" class="no-link">
                                    <li class="clickable">
                                        <div class="progress micro progress-{{progress}}"></div>
                                        <span class="title">{{title}}</span>
                                        <span class="subtitle">{{course}}</span>
                                    </li>
                                </a>
                            </ul>
                            {{/each}}
                        </li>
                        {{/each}}
                    </ul>
                </div>
                <div class="content-main">
                    <h2>Courses</h2>
                    {{#if courses.length}}
                    {{#each courses}}
                    <div class="course-listing">
                        <h3 class="course-title">{{title}}</h3>
                        <h4 class="teacher">{{instructor}}</h4><br />
                        <a href="/ap-physics-c" class="highlight">
                            <span class="upcoming-count highlight">{{upcoming}} Upcoming Assignments &raquo;</span>
                        </a>
                        <span class="upcoming-next">Next due today (needs fixing)</span>
                    </div>
                    {{/each}}
                    {{else}}
                    <p>No courses to display.</p>
                    {{/if}}
                </div>
            </div>
        </script>
        
        <script type="text/javascript">
            // TEMPORARY
            
            var data = {
                dates: [
                    {
                        date: "2014-06-17",
                        assignments: [
                            {
                                path: "/",
                                progress: "00",
                                title: "Waves: The Final Frontier",
                                course: "AP Physics C"
                            }
                        ]
                    },
                    {
                        date: "2014-06-18",
                        assignments: [
                            {
                                path: "/",
                                progress: "01",
                                title: "Waves: The Finaler Frontier",
                                course: "AP Physics C"
                            },
                            {
                                path: "/",
                                progress: "02",
                                title: "What is this class?",
                                course: "AP US History"
                            }
                        ]
                    },
                    {
                        date: "2014-06-19",
                        assignments: [
                            {
                                path: "/",
                                progress: "05",
                                title: "Waves: The Finalest Frontier",
                                course: "AP Physics C"
                            },
                            {
                                path: "/",
                                progress: "08",
                                title: "No, seriously, what is this class?",
                                course: "AP US History"
                            }
                        ]
                    },
                    {
                        date: "2014-06-30",
                        assignments: [
                            {
                                path: "/",
                                progress: "11",
                                title: "Course Survey",
                                course: "Linear Algebra"
                            }
                        ]
                    }
                ],
                courses: [
                    {
                        title: "AP Physics C",
                        instructor: "Scholla, Stephen M",
                        upcoming: 3
                    },
                    {
                        title: "AP US History",
                        instructor: "Sheptyck, Elizabeth A",
                        upcoming: 2
                    },
                    {
                        title: "Linear Algebra",
                        instructor: "Spoden, Myra S",
                        upcoming: 1
                    }
                ]
            };
        </script>
        
        <script type="text/javascript">
            $(document).ready(function(){
                var positionCounter = 0;
                
                Handlebars.registerHelper("position", function() {
                    return pad(positionCounter, 3);
                });
                
                Handlebars.registerHelper("incrementPosition", function() {
                    positionCounter++;
                    return "";
                });
                
                Handlebars.registerHelper("resetPosition", function() {
                    positionCounter = 0;
                    return "";
                });
                
                var dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
                var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sep", "Oct", "Nov", "Dec"];
                
                Handlebars.registerHelper("formatDate", function(date){
                    date = new Date(date)
                    date.setHours(24, 0, 0, 0);
                    day = new Date()
                    day.setHours(0, 0, 0, 0);
                    
                    name = ""
                    
                    for(i = 0; i < 7; i++){
                        if(day.getTime() == date.getTime()){
                            switch(i){
                                case 0:
                                    name = "Today";
                                    break;
                                case 1:
                                    name = "Tomorrow";
                                    break;
                                default:
                                    name = dayNames[day.getDay()];
                                    break;
                            }
                            break;
                        }
                        day = new Date(day.getTime() + 24*60*60*1000);
                    }
                    
                    if(name != ""){
                        if(name == "Today"){
                            return "<span class='title highlight'>Today</span><span class='subtitle'>" + monthNames[date.getMonth()] + " " + date.getDate() + "</span>";
                        }
                        return "<span class='title'>" + name + "</span><span class='subtitle'>" + monthNames[date.getMonth()] + " " + date.getDate() + "</span>";
                    } else {
                        return "<span class='title'>" + monthNames[date.getMonth()] + " " + date.getDate() + "</span>";
                    }
                });
                
                var out = $("body");
                var src = $("#template").html();
                
                var template = Handlebars.compile(src);
                var html = template(data);
                
                out.html(html);
            });
        </script>
    </head>
    <body></body>
</html>